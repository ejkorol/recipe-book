generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Item {
  id             String  @id @unique @default(uuid())
  name           String  @db.VarChar(255)
  description    String  @db.Text()
  image          String  @db.VarChar(255)
  itemTypeId     String
  stackSize      Int
  durability     Int?
  isMineable     Boolean @default(false)
  requiredToolId String?

  attributes ItemAttributeValue[]
  recipes    CraftingRecipeIngredient[]

  itemType       ItemType         @relation("ItemType", fields: [itemTypeId], references: [id])
  requiredTool   ItemType?        @relation("RequiredTool", fields: [requiredToolId], references: [id])
  CraftingRecipe CraftingRecipe[]

  @@map("items")
}

model ItemType {
  id          String  @id @unique @default(uuid())
  name        String  @db.VarChar(255)
  description String? @db.Text()

  items         Item[] @relation("ItemType")
  requiredItems Item[] @relation("RequiredTool")

  @@map("item_types")
}

model ItemAttribute {
  id          String @id @unique @default(uuid())
  name        String @db.VarChar(255)
  description String @db.Text()

  values ItemAttributeValue[]

  @@map("item_attributes")
}

model ItemAttributeValue {
  id          String @id @unique @default(uuid())
  itemId      String
  attributeId String
  value       Int

  item      Item          @relation(fields: [itemId], references: [id])
  attribute ItemAttribute @relation(fields: [attributeId], references: [id])

  @@map("item_attribute_values")
}

model CraftingRecipe {
  id           String @id @unique @default(uuid())
  resultItemId String
  quantity     Int

  resultItem  Item                       @relation(fields: [resultItemId], references: [id])
  ingredients CraftingRecipeIngredient[]

  @@map("crafting_recipes")
}

model CraftingRecipeIngredient {
  id       String @id @unique @default(uuid())
  recipeId String
  itemId   String
  quantity Int

  recipe CraftingRecipe @relation(fields: [recipeId], references: [id])
  item   Item           @relation(fields: [itemId], references: [id])

  @@map("crafting_recipe_ingredients")
}
